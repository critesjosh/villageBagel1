doctype html
//if lt IE 7
  html.no-js.lt-ie9.lt-ie8.lt-ie7(lang='')
//if IE 7
  html.no-js.lt-ie9.lt-ie8(lang='')
//if IE 8
  html.no-js.lt-ie9(lang='')
// [if gt IE 8] <!
html.no-js(lang='')
  // <![endif]
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge,chrome=1')
    title Village Bagel
    meta(name='description', content='')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    link(href='https://fonts.googleapis.com/css?family=Raleway:100|Roboto+Condensed:700', rel='stylesheet', type='text/css')
    link(rel='stylesheet', href='../css/styles.css')
    link(rel='stylesheet', href='../css/custom.css')
    script(src='../js/vendor/modernizr-2.8.3-respond-1.4.2.min.js')
  body
    //if lt IE 8
      p.browserupgrade
        | You are using an
        strong outdated
        |  browser. Please
        a(href='http://browsehappy.com/') upgrade your browser
        |  to improve your experience.
    #intro.header-container.fs
      img#logo(src="/img/logo.png")
      header.wrapper
    nav
      ul
        li
          a(href='#intro')
            span.nav-dot
            span.nav-label Village Bagel
        li
          a(href='#slide01')
            span.nav-dot
            span.nav-label Images
        li
          a(href='#slide02')
            span.nav-dot
            span.nav-label Order
        li
          a(href='#slide03')
            span.nav-dot
            span.nav-label Contact
    .main-container
      article#cb01.content-block
        .wrapper
          header.slideInUp
            h1 Contact Us
          section
          section
            p.slideInUp.slideInUp2
              a(style='text-decoration: none;', href='mailto:villagebagel1@gmail.com') Email us here
            p.slideInUp.slideInUp2
              | Custom order by calling or texting
              a(style='text-decoration: none;', href='tel:19148868851')  (914) 886-8851
              |  or use our
              a(style='text-decoration: none; color: darkblue', href="/order" )  online ordering system
            .slideInUp.slideInUp3
              h2 Or Catch us for "Back Door Bagels"
              p
                | Most Mornings out of the Kitchen Entrance of Mirabelle Restaurant
                br
                |55 Village Road
                br
                |Avon, CO, 81620
                br
                |Call
                a(style='text-decoration: none;', href="tel:19148868851")  (914) 886-8861
                |  ahead of time so we don’t miss you
        // .wrapper
      article#slide01.slide.fs
        .wrapper
          header.slideInUp
            h1
          section
            p.slideInUp.slideInUp2
        // .wrapper
      article#cb02.content-block
        .wrapper
          header.slideInUp
            h1 Menu
          section
            p.slideInUp.slideInUp2
            p.slideInUp.slideInUp2 <strong style='font-size: 24px;'>​​​​Hand-Rolled Bagels:</strong> <br> <span style='font-size:16px;'>$2.50 | $12.00 half dozen | $23.00 baker’s dozen <br> Plain | Salt | Poppy | Sesame | Onion | Everything | Garlic | Cinnamon Raisin</span>
            p.slideInUp.slideInUp3 <strong style='font-size: 24px;'>Shmears:</strong> <br>  <span style='font-size:16px;'>$5.00 half pound | $9.00 pound <br> Whipped Plain | Hatch Green Chili | Honey Rosemary | Bacon | Veggie | Chive &amp; Onion | Nutella Swirl | Maple Walnut</span>
            p.slideInUp.slideInUp3 <strong style='font-size: 24px;'>Spreads:</strong> <br> <span style='font-size:16px;'> $2.00 Single Serving | $6.00 Half Pound <br> Avocado | Almond Butter | Strawberry Preserves | Hummus </span>

        // .wrapper
      article#slide02.slide.fs
        .wrapper
          header.slideInUp
            h1
          section
            p.slideInUp.slideInUp2
            p.slideInUp.slideInUp3
        // .wrapper
      article#cb03.content-block
        .wrapper
          header.slideInUp
            h1
              a(href="/order" style="text-decoration:none;") Order Here
          section
            p.slideInUp.slideInUp2
        // .wrapper
      article#slide03.slide.fs
        .wrapper
          header.slideInUp
            h1
          section
            p.slideInUp.slideInUp2
            p.slideInUp.slideInUp2
            .slideInUp.slideInUp3
              h2
              p
        // .wrapper
    // #main-container
    .footer-container
      footer
      .wrapper
        <br>
        h1 Tell your friends
        section
          a(target='_blank', title='follow me on twitter', href='http://www.twitter.com/PLACEHOLDER')
            img(class="social-icon" alt='follow me on twitter', src='../img/twitter-icon.png', border='0')
          a(target='_blank', title='follow me on instagram', href='http://www.facebook.com/PLACEHOLDER')
            img(class="social-icon" alt='follow me on facebook', src='../img/facebook-icon.png', border='0')
          a(target='_blank', title='follow me on twitter', href='http://www.instagram.com/PLACEHOLDER')
            img(class="social-icon" alt='follow me on twitter', src='../img/instagram-icon.png', border='0')
          a(target='_blank', href='mailto:name@email.com?subject=Check%20out%20this%20cool%20spot.&body=Check%20out%20villagebagel.co')
            img(class="social-icon" alt='follow me on twitter', src='../img/email-icon.png', border='0')
          |<br/>
          |<br>
    script(src='//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js')
    script.
      window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\\/script>')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/debug.addIndicators.min.js')
    script(type='text/javascript', src='https://js.squareup.com/v2/paymentform')
    script(src='../js/main.js')
    script(src='../js/custom.js')
    script(type='text/javascript').
      console.log(cart)
      var cardNonce;
      var paymentForm = new SqPaymentForm({
      applicationId: '#{square_application_id}',
      inputClass: 'sq-input',
      inputStyles: [
      {
      fontSize: '14px',
      padding: '7px 12px',
      backgroundColor: "transparent"
      }
      ],
      cardNumber: {
      elementId: 'sq-card-number',
      placeholder: '0000 0000 0000 0000'
      },
      cvv: {
      elementId: 'sq-cvv',
      placeholder: 'CVV'
      },
      expirationDate: {
      elementId: 'sq-expiration-date',
      placeholder: 'MM/YY'
      },
      postalCode: {
      elementId: 'sq-postal-code',
      placeholder: '94110'
      },
      callbacks: {
      cardNonceResponseReceived: function(errors, nonce, cardData) {
      if (errors){
      var error_html = ""
      for (var i =0; i < errors.length; i++){
      error_html += "<li> " + errors[i].message + " </li>";
      }
      document.getElementById("card-errors").innerHTML = error_html;
      document.getElementById('submit').disabled = false;
      }else{
      document.getElementById("card-errors").innerHTML = "";
      chargeCardWithNonce(nonce);
      }
      },
      unsupportedBrowserDetected: function() {
      // Alert the buyer
      alert('unsupported Browser Detected')
      }
      }
      });
      // build payment form after DOM load
      document.addEventListener('page:change', function(){
      console.log('dom loaded')
      paymentForm.build()
      });
      var paymentFormSubmit = function(){
      event.preventDefault()
      console.log('submit clicked');
      document.getElementById('submit').disabled = true;
      paymentForm.requestCardNonce();
      return false;
      }
      var chargeCardWithNonce = function(nonce) {
      var productsString = '';
      cart.forEach(function(element){
      productsString = productsString + element.string + ','
      })
      var products = cart;
      var name =  "null" || document.getElementById('name').value;
      var email = document.getElementById('email').value || "null";
      var street_address_1 = "null" || document.getElementById('street_address_1').value;
      var street_address_2 = "null" || document.getElementById('street_address_2').value;
      var city = "null" || document.getElementById('city').value;
      var state = "null" || document.getElementById('state').value;
      var zip = "null" || document.getElementById('zip').value;
      var http = new XMLHttpRequest();
      var url = "/charges/charge_card";
      var params = "products=" + productsString
      +"&name=" + name
      +"&email=" + email
      + "&nonce=" + nonce
      + "&street_address_1=" + street_address_1
      + "&street_address_2=" + street_address_2
      + "&city=" + city
      + "&state=" + state
      + "&zip=" + zip;
      http.open("POST", url, true);
      //Send the proper header information along with the request
      http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      http.setRequestHeader("X-CSRF-Token", "<%= form_authenticity_token %>");
      http.onreadystatechange = function() {//Call a function when the state changes.
      if(http.readyState == 4 && http.status == 200) {
      var data = JSON.parse(http.responseText)
      if (data.status == 200) {
      document.getElementById("successNotification").style.display = "block";
      document.getElementById("payment-form").style.display = "none";
      window.scrollTo(0, 0);
      }else if (data.status == 400){
      var error_html = ""
      for (var i =0; i < data.errors.length; i++){
      error_html += "<li> " + data.errors[i].detail + " </li>";
      }
      document.getElementById("card-errors").innerHTML = error_html;
      document.getElementById('submit').disabled = false;
      }
      }
      }
      http.send(params);
      }
